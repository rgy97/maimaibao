<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="../css/car.css">
    <link rel="stylesheet" href="../css/common.css">
    <title>购物车</title>
</head>
<body>
 <div class="top">
        <div class="pic">
            <a href="#"></a>
        </div>
    </div>
    <div id="top">
        <div class="box">
        <div class="left">您好！欢迎来到买卖宝商城！</div>
        <ul class="right">
            <li>
                <a href="#" class="qq">QQ账号快速登录</a>
                <span>|</span>
            </li>
            <li>
                <a href="#">买卖宝账号登录</a>
                <span>|</span>
            </li>
            <li>
                <a href="#">注册</a>
                <span>|</span>
            </li>
            <li>
                <a href="#">查单</a>
                <span>|</span>
            </li>
            <li>
                <a href="#">收藏本站</a>
                <span>|</span>
            </li>
            <li>
                <a href="#" class="ld">客户端下载</a>
                <span>|</span>
            </li>
            <li>
                <a href="#">买卖宝商城服务热线:</a>
               
            </li>
            <li class="ph">0510-80246888分机8008；分机8009</li>
        </ul>
    </div>
</div>
<div id="cart_main">
    <div class="cart_top">
         <div class="home">
        <a href="#">
                <img src="http://rep3.mmb.cn/wap/upload/mmbPc/header/logo.png">
        </a>
    </div>
    <div class="cart_bar">
            <table>
					<tbody><tr>
						<td class="colo">查看购物车</td>
						<td>填写订单</td>
						<td>付款，完成购买</td>
					</tr>
                </tbody>
            </table>
    </div>
 </div>
<div class="cart_content">
        <h2>我的购物车</h2>
        <div class="cart_pro">
            <table class="tab1">
               <tr>
                   <td class="ite1"><input type="checkbox" name="quanxuan" id="selectAll" checked="checked">全选</td>
                   <td class="ite2">商品名称</td>
                   <td class="ite3">单价(元)</td>
                   <td class="ite4">数量</td>
                   <td class="ite5">操作</td>
               </tr>
            </table>
        </div>
        <div class="shoplist">
<!-- 			
				'<div class="shop-item clearfix">'+
					'<p class="fl"><input type="checkbox" class="ck"/></p>'+
					'<img class="fl" src="img/'+ shopinfo.src +'" alt="" />'+
					'<p class="fl">'+ shopinfo.name +'</p>'+
					'<span class="fl">'+ shopinfo.price +'元</span>'+
					'<p class="fl count" '+
						'data-id="'+ shopinfo.id +'" '+
						'data-price="'+ shopinfo.price +'" data-count="'+ shopinfo.count +'"'+
						'data-name="'+ shopinfo.name +'" data-src="'+ shopinfo.src +'"'+
						'>'+
						'<span class="updateCount" data-number="1">+</span>'+
						'<span class="shop-count">'+ shopinfo.count +'</span>'+
						'<span class="updateCount" data-number="-1">-</span>'+
					'</p>'+
					'<em class="fl sumPrice">'+ (shopinfo.count * shopinfo.price) +'元</em>'+
					'<i class="fl delBtn">删除</i>'+
				'</div>';
			 -->
		</div>
		<div id="sum" class="clearfix">
			共多少<span class="count2"></span>件商品，合计<span class="money2"></span>元
		</div>
        <div class="no_product">
                <img src="http://rep3.mmb.cn/wap/upload/mmbPc/product/gouwuche2.png">
                <div>
                购物车内暂时没有商品，您可以
                <a href="./home.html">选购商品</a>
                </div>
            </div>
            <div id="delDialog" style="display:none">
                    <h2>&nbsp;&nbsp;删除商品<a href="javascript:;">X</a></h2>
                    <div>
                    <p>确定删除选中的商品吗?</p>
                    <form action="/wap/pc/acart.do?uuniq=1544520574871762">
                        <input type="hidden" id="proIds" name="id">
                        <input type="hidden" id="types" name="type">
                        <input type="hidden" id="m" name="m" value="batchDel">
                        <input type="submit" value="确定">				
                        <input type="button" value="取消">				
                    </form>
                    </div>
            </div>
</div>
<div class="cart_sumbit">
    <a href="../pages/product.html">继续购物</a>
    <form action="">
        <input type="hidden" value="1" name="pay">
        <input type="submit" class="input_js" value="&nbsp;" id="submitBtn">
    </form>
</div>
<div class="ensure">
        购物保障:
        <span class="en1">100%正品</span>
        <span class="en2">10天退换货</span>
        <span class="en3">全国货到付款</span>
    </div>
</div>
<div id="footer">
    <div class="footer_server1">
         <div class="sev">
                <div class="tp tp1"></div>
                <div class="artic">
                    <h3>全国满138包邮</h3>
                    <h4>高效的物流直达配送</h4>
                </div>
         </div>
         <div class="sev">
                <div class="tp tp2"></div>
                <div class="artic">
                    <h3>货到付款</h3>
                    <h4>安全无忧放心购买</h4>
                </div>
                
         </div>
         <div class="sev">
                <div class=" tp tp3"></div>
                <div class="artic">
                    <h3>7天无理由退货</h3>
                    <h4>15天无理由换货</h4>
                </div>
                
         </div>
    </div>
    <div class="footer_server2">
        <div class="footer_left">
            <ul>
                <li>
                    <h3>购物指南</h3>
                    <p><a href="#">订购商品</a></p>
                    <p><a href="#">配送规则</a></p>
                    <p><a href="#">订单查询</a></p>
                    <p><a href="#">商品积分</a></p>
                </li>
                <li>
                    <h3>售后服务</h3>
                    <p><a href="#">退换货规则</a></p>
                    <p><a href="#">退换货流程</a></p>
                    <p><a href="#">运费说明</a></p>
                    <p><a href="#">隐私保护</a></p>
                    </li>
                <li>
                    <h3>会员服务</h3>
                    <p><a href="#">会员身份</a></p>
                    <p><a href="#">会员信息变更</a></p>
                    <p><a href="#">会员优势</a></p>
                </li>
                <li>
                    <h3>买卖宝商城客服热线</h3>
                    <p><a href="#">400-886-9499</a></p>
                    <p><a style="color:#fff;" href="#">售后：400-886-9499</a></p>
                </li>
            </ul>
        </div>
        <div class="footer_right">
            <div class="mmb_l">
                <p>买卖宝安卓客户端</p>
                <p><img src="http://rep3.mmb.cn/wap/upload/mmbPc/qt/app.jpg" width="100px"></p>
                <p><a href="#">下载有惊喜</a></p>
            </div>
            <div class="mmb_l">
                <p>关注买卖宝微信</p>
                <p><img src="http://rep3.mmb.cn/wap/upload/mmbPc/qt/wx.jpg" width="100px"></p>
                <p>扫一扫有惊喜</p>
            </div>
        </div>
    </div>
</div>
<footer>
    <div class="down">
        <div class="down_left">
            <div class="pc">
                <img src="http://rep3.mmb.cn/wap/upload/mmbPc/header/footer_a.jpg" style="border: medium none;" alt="安全联盟认证">
                <p>中国信用企业</p>
            </div>
            <div class="pc">
                    <img src="http://odr.jsdsgsxt.gov.cn:8081/mbm/app/main/electronic/images/ebsIcon.png" title="" alt="" width="32" height="45" border="0" style="border-width:0px;border:hidden; border:none;">
                    <p>电子营业执照</p>
             </div>
        </div>
        <div class="down_right">
            <p>
                <a href="#" style="margin-left:0;">买卖宝商城首页</a>|
                <a href="#">帮助中心</a>|
                <a href="#">关于我们</a>|
                <a href="#">加入我们</a>|
                <a href="#">给阿宝提建议</a>
            </p>
            <p>Copyright © 2014 Maimaibao.com  保留所有权利。</p>
            <p>无锡买卖宝信息技术有限公司北京分公司Maimaibao.com 本站经中国互联网协会认定"信用等级:AAA"，苏ICP备10122122号</p>
        </div>
    </div>
</footer>   
</body>
<script src="../javascripts/jquery-1.11.3.js"></script>
<script src="../javascripts/common.js"></script>
<script>
   window.onload = function(){
    var arr = getCookie("shoplist");
		var str = "";
		for( var i = 0 ; i < arr.length ; i++ ){
			var shopinfo = arr[i];
            str += '<div class="shop-item clearfix">'+
					'<p class="fl"><input type="checkbox" class="ck"/></p>'+
					'<img class="fl" src="'+ shopinfo.src +'" alt="" />'+
					'<p class="fl">'+ shopinfo.name +'</p>'+
					'<span class="fl">'+ shopinfo.price +'元</span>'+
					'<p class="fl count" '+
						'data-id="'+ shopinfo.id +'" '+
						'data-price="'+ shopinfo.price +'" data-count="'+ shopinfo.count +'"'+
						'data-name="'+ shopinfo.name +'" data-src="'+ shopinfo.src +'"'+
						'>'+
						'<span class="updateCount" data-number="1">+</span>'+
						'<span class="shop-count">'+ shopinfo.count +'</span>'+
                        '<span class="updateCount" data-number="-1">-</span>'+
                        '</p>'+
                        '<i class="fl delBtn">删除</i>'+
				'</div>';
		}
		$(".shoplist").html(str);
        if(getCookie("shoplist")==""){
        $(".no_product").css({"display":"block"})
       }else{
        $(".no_product").css({"display":"none"})
       }
   //全选效果
		$("#selectAll").click(function(){
			$(".ck").prop( "checked" , $(this).prop("checked") );
			jiesuan();
        })
    //结算功能
    function jiesuan(){
                var count = 0;
                var money = 0;
                //结算被选中的复选框对应的对象
                $(".ck:checked").each( function(){
                    count += parseInt( $(this).parent().parent().find(".shop-count").html() ); 
                    money += parseInt( $(this).parent().parent().find(".sumPrice").html() ); 
                } )
                $(".count2").html( count );
                $(".money2").html( money );
            }

            //当点击前面的复选框时  实现结算
		$(".ck").click(function(){
			jiesuan();
        })
        //删除操作
		$(".delBtn").click(function(){
            console.log(77777777777777777)
			if( confirm("确定要删除么?") ){
				//确定要删除的商品编号
				var id = $(this).parent().find(".count").data("id");
				//遍历数组  找到数组中要删除的商品
				for( var i = 0 ; i < arr.length ; i++ ){
					if( id == arr[i].id ){
					
						//将数组中的对象删除     splice(start,len)
						arr.splice( i , 1 );
					
						//同时重新设置修改后的数组 存入到cookie中
						setCookie("shoplist",JSON.stringify( arr ));
						//修改页面 remove()
						$(this).parent().remove();
					}
				}
			}
        })
        
        //加减操作  
		$(".updateCount").click( function(){
			//确定要操作的对象（根据对象编号id）
			var id = $(this).parent().data("id");
			//取出操作的data-number值
			var sign = $(this).data("number");
			//获取当前操作的商品数量
			var count = $(this).parent().find(".shop-count").html();
			
			//如果商品的数量是1  并且操作的是  -  就不需要执行下面的操作了
			if( count == 1 && sign == -1 ){
				return ;
			}
			//遍历数组arr  确定要操作的对象  将该对象的count属性++ 或 --
			for( var i = 0 ; i < arr.length ; i++ ){
				if( id == arr[i].id ){//找到了要操作的商品对象
					//改变arr[i].count值
					arr[i].count+=sign;
					//将改变后的数组重新存入到cookie中
					setCookie( "shoplist",JSON.stringify( arr ) );
					
					//改变页面中的数量  
					//将数组中 arr[i].count值  回填到页面上
					$(this).parent().find(".shop-count").html( arr[i].count );
					//将总金额改变
                    $(this).parent().parent().parent().next().children().next().html( arr[i].count*arr[i].price + "元" );
					jiesuan();
                }
            }
		} )
   }

   
	
</script>
</html>